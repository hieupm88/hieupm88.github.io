window.__require=function t(o,i,e){function n(r,c){if(!i[r]){if(!o[r]){var h=r.split("/");if(h=h[h.length-1],!o[h]){var a="function"==typeof __require&&__require;if(!c&&a)return a(h,!0);if(s)return s(h,!0);throw new Error("Cannot find module '"+r+"'")}}var l=i[r]={exports:{}};o[r][0].call(l.exports,function(t){return n(o[r][1][t]||t)},l,l.exports,t,o,i,e)}return i[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<e.length;r++)n(e[r]);return n}({CanvasScaleByOrientation:[function(t,o,i){"use strict";cc._RF.push(o,"05360OOIDtG0rxnGUvbwUiw","CanvasScaleByOrientation"),cc.Class({extends:cc.Component,properties:{autoOrientation:!1,isPortrait:!0,canvas:cc.Canvas,fitByOrientation:!0,useCustomDesignResolution:!1,customDSWidth:1280,customDSHeight:720,widgetNodes:{type:cc.Widget,default:[]},isDebug:!1},onLoad:function(){if(this._thisOnResized=this.onScreenResized.bind(this),cc.sys.isMobile?window.addEventListener("resize",this._thisOnResized):cc.view.on("canvas-resize",this._thisOnResized),this.scaleCanvasByOrientation(),!cc.sys.isNative){var t=document.getElementById("div_full_screen");this.isPortrait&&t&&(t.style.visibility="hidden"),this.autoOrientation?cc.view.setOrientation(cc.macro.ORIENTATION_AUTO):this.isPortrait?cc.view.setOrientation(cc.macro.ORIENTATION_PORTRAIT):cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE)}},start:function(){if(cc.sys.isMobile){var t=new Event("gameShow");window.dispatchEvent(t)}},scaleCanvasByOrientation:function(){if(this.autoOrientation?cc.view.getFrameSize().width<cc.view.getFrameSize().height?this.isPortrait=!0:this.isPortrait=!1:this.isPortrait?cc.view.setOrientation(cc.macro.ORIENTATION_PORTRAIT):cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE),this.canvas){if(this.isDebug&&cc.log("Canvas after update: "),this.isDebug&&cc.log(this.canvas),this.canvas.alignWithScreen(),this.fitByOrientation){var t=this.useCustomDesignResolution?this.customDSWidth/this.customDSHeight:this.canvas.designResolution.width/this.canvas.designResolution.height,o=cc.view.getFrameSize(),i=o.width/o.height;this.isDebug&&cc.log("View size:"+o+", Design Resolution: W: "+this.canvas.designResolution.width+", H: "+this.canvas.designResolution.height+",  Screen Ratio: "+i+", Design Ratio: "+t),this.isPortrait?i<t?(this.canvas.fitHeight=!1,this.canvas.fitWidth=!0,this.isDebug&&cc.log("CANVAS FIT WIDTH")):(this.canvas.fitHeight=!0,this.canvas.fitWidth=!1,this.isDebug&&cc.log("CANVAS FIT HEIGHT")):i<t?(this.canvas.fitHeight=!1,this.canvas.fitWidth=!0):(this.canvas.fitHeight=!0,this.canvas.fitWidth=!1)}}else this.isDebug&&cc.log("No canvas component");if(this.widgetNodes&&this.widgetNodes.length>0)for(var e=0;e<this.widgetNodes.length;e++)this.widgetNodes[e].updateAlignment()},onScreenResized:function(){var t=cc.visibleRect;this.scaleCanvasByOrientation(),this.isDebug&&cc.log("ON SCREEN RESIZE: NEW CANVAS SIZE: Width: "+t.width+", Height: "+t.height)},onDestroy:function(){cc.sys.isMobile?window.removeEventListener("resize",this._thisOnResized):cc.view.off("canvas-resize",this._thisOnResized)}}),cc._RF.pop()},{}],ColorPalletControl:[function(t,o,i){"use strict";cc._RF.push(o,"8d4f58uLMlKlLHXvJGjq9H5","ColorPalletControl");var e=cc.Enum({HEAD_COLOR:0,BODY_COLOR:1,FOOD_COLOR:2,BLOCK_COLOR:3});cc.Class({extends:cc.Component,properties:{palletType:{type:e,default:e.HEAD_COLOR},target:cc.Node,defaultIndex:6,colorNodes:[cc.Node]},init:function(t,o){this.gameControl=t,this.config=o,this._colorIndex=this.defaultIndex,this._currentColor=cc.Color.WHITE},onOpen:function(){var t=this.colorNodes[this._colorIndex];if(t){t.stopAllActions(),t.scale=1;var o=t.children[0];o&&(this._currentColor=o.color),t.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2,1.2).easing(cc.easeBackOut()),cc.scaleTo(.5,1,1).easing(cc.easeBackOut())))),this.changeGameColor()}},onClose:function(){var t=this.colorNodes[this._colorIndex];t&&(t.stopAllActions(),t.scale=1)},onColorChange:function(t){var o=t.currentTarget;if(o){var i=o.children[0];i&&(this._currentColor=i.color);var e=this.colorNodes[this._colorIndex];e&&(e.stopAllActions(),e.scale=1),this._colorIndex=this.colorNodes.indexOf(o),this._colorIndex>-1&&(o.stopAllActions(),o.scale=1,o.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2,1.2).easing(cc.easeBackOut()),cc.scaleTo(.5,1,1).easing(cc.easeBackOut()))))),this.saveColorData(this._currentColor),this.changeGameColor()}},changeGameColor:function(){switch(this.target.color=this._currentColor,this.palletType){case e.HEAD_COLOR:this.gameControl&&this.gameControl.onChangeHeadColor(this._currentColor);break;case e.BODY_COLOR:this.gameControl&&this.gameControl.onChangeBodyColor(this._currentColor);break;case e.FOOD_COLOR:this.gameControl&&this.gameControl.onChangeFoodColor(this._currentColor);break;case e.BLOCK_COLOR:this.gameControl&&this.gameControl.onChangeBlockColor(this._currentColor)}},saveColorData:function(t){var o=this.config.GAME_ID+"_COLOR"+this.palletType,i={currentColor:{r:this._currentColor.r,g:this._currentColor.g,b:this._currentColor.b,a:this._currentColor.a},currentIndex:this._colorIndex};cc.sys.localStorage.setItem(o,JSON.stringify(i))},loadColorData:function(){var t=this.config.GAME_ID+"_COLOR"+this.palletType,o=JSON.parse(cc.sys.localStorage.getItem(t));if(o){var i=o.currentColor,e=o.currentIndex;i&&(this._currentColor=new cc.Color(i.r,i.g,i.b,i.a)),e&&(this._colorIndex=e),this.changeGameColor()}}}),cc._RF.pop()},{}],Config:[function(t,o,i){"use strict";cc._RF.push(o,"83465+4DS5Lo5jyi5EAHeS3","Config"),cc.Class({extends:cc.Component,onLoad:function(){this.node.config={GAME_ID:"SNAKE_HUNT_2021",FRAME_RATE:100,STEP_DISTANCE:20,STEP_SPEED:90,HEAD_WIDTH:20,HEAD_HEIGHT:20,BODY_WIDTH:20,BODY_HEIGHT:20,INIT_DIRECTION:cc.v2(0,1),MIN_DISTANCE:1,TILE:1,LEVELS:[{ID:"1",FOOD_COUNT:15,ADDED_SPEED:5,MORE_BLOCKS:[]},{ID:"2",FOOD_COUNT:40,ADDED_SPEED:10,MORE_BLOCKS:[{x:-5,y:0},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:5,y:0},{x:4,y:0},{x:3,y:0},{x:2,y:0}]},{ID:"3",FOOD_COUNT:60,ADDED_SPEED:15,MORE_BLOCKS:[{x:-5,y:-5},{x:-4,y:-5},{x:-3,y:-5},{x:-2,y:-5},{x:5,y:-5},{x:4,y:-5},{x:3,y:-5},{x:2,y:-5},{x:-5,y:5},{x:-4,y:5},{x:-3,y:5},{x:-2,y:5},{x:5,y:5},{x:4,y:5},{x:3,y:5},{x:2,y:5}]},{ID:"4",FOOD_COUNT:90,ADDED_SPEED:20,MORE_BLOCKS:[{x:-8,y:-5},{x:-4,y:-5},{x:-3,y:-5},{x:-2,y:-5},{x:8,y:-5},{x:4,y:-5},{x:3,y:-5},{x:2,y:-5},{x:7,y:-5},{x:-8,y:0},{x:-7,y:0},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:8,y:0},{x:4,y:0},{x:3,y:0},{x:2,y:0},{x:7,y:0},{x:-8,y:5},{x:-7,y:5},{x:-4,y:5},{x:-3,y:5},{x:-2,y:5},{x:8,y:5},{x:4,y:5},{x:3,y:5},{x:2,y:5},{x:7,y:5}]},{ID:"5",FOOD_COUNT:140,ADDED_SPEED:0,MORE_BLOCKS:[{x:-12,y:-8},{x:-10,y:-8},{x:-5,y:-8},{x:-1,y:-8},{x:1,y:-8},{x:5,y:-8},{x:10,y:-8},{x:12,y:-8},{x:-5,y:0},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:5,y:0},{x:4,y:0},{x:3,y:0},{x:2,y:0},{x:-12,y:8},{x:-10,y:8},{x:-5,y:8},{x:-1,y:8},{x:1,y:8},{x:5,y:8},{x:10,y:8},{x:12,y:8}]},{ID:"6",FOOD_COUNT:200,ADDED_SPEED:25,MORE_BLOCKS:[{x:-12,y:-15},{x:-10,y:-14},{x:-5,y:-13},{x:-1,y:-12},{x:1,y:-12},{x:5,y:-13},{x:10,y:-14},{x:12,y:-15},{x:-12,y:-8},{x:-10,y:-8},{x:-5,y:-8},{x:-1,y:-8},{x:1,y:-8},{x:5,y:-8},{x:10,y:-8},{x:12,y:-8},{x:-5,y:0},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:5,y:0},{x:4,y:0},{x:3,y:0},{x:2,y:0},{x:-12,y:8},{x:-10,y:8},{x:-5,y:8},{x:-1,y:8},{x:1,y:8},{x:5,y:8},{x:10,y:8},{x:12,y:8},{x:-12,y:15},{x:-10,y:14},{x:-5,y:13},{x:-1,y:12},{x:1,y:12},{x:5,y:13},{x:10,y:14},{x:12,y:15}]}]}}}),cc._RF.pop()},{}],GameControl:[function(t,o,i){"use strict";cc._RF.push(o,"b647d9xClRMyYItMj/XEf6x","GameControl");var e=t("MovementControl"),n=t("MapControl"),s=t("PlayerControl"),r=t("UIControl"),c=t("SettingPanelControl");cc.Class({extends:cc.Component,properties:{movementControl:e,mapControl:n,playerControl:s,uiControl:r,settingControl:c},onLoad:function(){this.poolFactory=this.node.getComponent("PoolFactory"),this.playerControl&&(this.playerControl.node.on("ON_EAT_FOOD",this.onEatFood,this),this.playerControl.node.on("ON_COLLIDE_BLOCK",this.onCollideBlock,this)),this.uiControl&&(this.uiControl.node.on("START_GAME",this.startPlaying,this),this.uiControl.node.on("RESTART_GAME",this.restartGame,this),this.uiControl.node.on("NEXT_LEVEL",this.nextLevel,this),this.uiControl.node.on("PAUSE_GAME",this.pauseGame,this),this.uiControl.node.on("RESUME_GAME",this.resumeGame,this),this.uiControl.node.on("OPEN_SETTING",this.openSetting,this),this.uiControl.node.on("CLOSE_SETTING",this.closeSetting,this))},start:function(){var t=this;this._isPlaying=!1;var o=cc.director.getCollisionManager();o&&(o.enabled=!0),cc.macro.ENABLE_MULTI_TOUCH=!1;var i=this.node.config,e=i.FRAME_RATE,n=i.LEVELS;this.maxLevel=n.length-1,this.settingControl&&this.settingControl.init(this,this.node.config),this.uiControl&&this.uiControl.init(this.node.config),this.movementControl.initGame(this.node.config,this.poolFactory),this.mapControl.initMap(this.node.config,this.poolFactory),cc.game.setFrameRate(e),this._currentLevel=0,this._addedSpeed=0,this.setUpLevel(),this.scheduleOnce(function(){t.settingControl&&t.settingControl.loadData()},.1)},setUpLevel:function(){this.mapControl.resetMap(),this.mapControl.setUpMoreBlocks(this._currentLevel);var t=this.node.config.LEVELS;this.mapControl.spawnFood(this.playerControl.paths);var o=t[this._currentLevel];if(o){var i=o.ID,e=o.FOOD_COUNT,n=o.ADDED_SPEED;this.uiControl&&(this.uiControl.level=i),this._maxFoodCount=e,n&&(this._addedSpeed=n)}this._currentFoodCount=0},restartGame:function(){this._currentLevel=0,this.setUpLevel(),this.playerControl&&(this.playerControl.reset(),this.startPlaying())},nextLevel:function(){this._currentLevel++,this._currentLevel>=this.maxLevel&&(this._currentLevel=0,this.node.config.STEP_SPEED+=10,this.node.config.TILE++),this.setUpLevel(),this.playerControl&&(this.playerControl.reset(),this.startPlaying(),this.playerControl.increaseSpeed(this._addedSpeed))},pauseGame:function(){this._isPlaying=!1,this.playerControl&&(this.playerControl.isMoving=!1)},resumeGame:function(){this._isPlaying=!0,this.playerControl&&(this.playerControl.isMoving=!0)},closeSetting:function(){this.settingControl&&this.settingControl.hide(),this._isGameStarted&&this.uiControl&&this.uiControl.resumeGame()},openSetting:function(){this.settingControl&&this.settingControl.show(),this._isGameStarted&&this._isGameStarted&&this.uiControl&&this.uiControl.pauseGame()},startPlaying:function(){this._isPlaying||(this._isPlaying=!0,this.movementControl&&this.movementControl.startMoving(),this._isGameStarted=!0)},stopPlaying:function(){this._isPlaying&&(this._isPlaying=!1,this.movementControl&&this.movementControl.stopMoving(),this.uiControl&&this.uiControl.onGameOver())},onEatFood:function(t){this.mapControl&&(this.mapControl.removeEatenFood(t),this.mapControl.spawnFood(this.playerControl.paths)),this.uiControl&&(this.uiControl.onScored(1),this._currentFoodCount++,this._currentFoodCount>=this._maxFoodCount&&(this._isPlaying=!1,this.movementControl&&this.movementControl.stopMoving(),this.uiControl.onGameWon()))},onCollideBlock:function(){this.stopPlaying(),this.uiControl&&this.uiControl.onGameOver()},onChangeHeadColor:function(t){this.playerControl&&this.playerControl.changeHeadColor(t)},onChangeBodyColor:function(t){this.playerControl&&this.playerControl.changeBodyColor(t)},onChangeFoodColor:function(t){this.mapControl&&this.mapControl.changeFoodColor(t)},onChangeBlockColor:function(t){this.mapControl&&this.mapControl.changeBlockColor(t)},onDestroy:function(){this.playerControl&&(this.playerControl.node.off("ON_EAT_FOOD",this.onEatFood,this),this.playerControl.node.off("ON_COLLIDE_BLOCK",this.onCollideBlock,this)),this.uiControl&&(this.uiControl.node.off("START_GAME",this.startPlaying,this),this.uiControl.node.off("RESTART_GAME",this.restartGame,this),this.uiControl.node.off("NEXT_LEVEL",this.nextLevel,this))}}),cc._RF.pop()},{MapControl:"MapControl",MovementControl:"MovementControl",PlayerControl:"PlayerControl",SettingPanelControl:"SettingPanelControl",UIControl:"UIControl"}],HeadControl:[function(t,o,i){"use strict";cc._RF.push(o,"248be68+sBND6CwcBKWAvVW","HeadControl"),cc.Class({extends:cc.Component,properties:{},init:function(t){this.player=t,this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.2,1.2).easing(cc.easeBackOut()),cc.scaleTo(.5,1,1))))},onCollisionEnter:function(t,o){t&&("Food"===t.node.name?this.player&&this.player.onEatFood(t.node):"Block"===t.node.name&&this.player&&this.player.onCollideBlock())},onDestroy:function(){this.node.stopAllActions(),this.player=null}}),cc._RF.pop()},{}],KeyboardInputControl:[function(t,o,i){"use strict";cc._RF.push(o,"5c1aeT3cN9GTZoMvZ0fDN2s","KeyboardInputControl");var e=t("MovementControl"),n=t("GameControl");cc.Class({extends:cc.Component,properties:{movementControl:e,gameControl:n},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},start:function(){},onKeyDown:function(t){if(this.movementControl)switch(t.keyCode){case cc.macro.KEY.left:console.log("Move Left"),this.movementControl.horizontalAxis=-1;break;case cc.macro.KEY.right:console.log("Move Right"),this.movementControl.horizontalAxis=1;break;case cc.macro.KEY.up:console.log("Move Up"),this.movementControl.verticalAxis=1;break;case cc.macro.KEY.down:console.log("Move Down"),this.movementControl.verticalAxis=-1;break;case cc.macro.KEY.a:console.log("Move Left"),this.movementControl.horizontalAxis=-1;break;case cc.macro.KEY.d:console.log("Move Right"),this.movementControl.horizontalAxis=1;break;case cc.macro.KEY.w:console.log("Move Up"),this.movementControl.verticalAxis=1;break;case cc.macro.KEY.s:console.log("Move Down"),this.movementControl.verticalAxis=-1}},onKeyUp:function(t){this.movementControl&&this.movementControl.resetInput()},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)}}),cc._RF.pop()},{GameControl:"GameControl",MovementControl:"MovementControl"}],MapControl:[function(t,o,i){"use strict";function e(t){if(Array.isArray(t)){for(var o=0,i=Array(t.length);o<t.length;o++)i[o]=t[o];return i}return Array.from(t)}cc._RF.push(o,"3b22e5azxVACqr65kdFFAi+","MapControl"),cc.Class({extends:cc.Component,properties:{foodPrefabName:"Food",blockPrefabName:"Block",gridWidth:100,gridHeight:150},initMap:function(t,o){this.config=t,this.poolFactory=o;var i=this.config.STEP_DISTANCE;this.grid=[],this.blocks=[],this.moreBlocks=[],this.blockPositions=[],this.moreBlockPositions=[],this.startPos=cc.v2(-this.gridWidth/2*i+i/2,this.gridHeight/2*i-i/2);for(var e=0;e<this.gridHeight;e++)for(var n=0;n<this.gridWidth;n++){var s=cc.v2(this.startPos.x+i*n,this.startPos.y-i*e);if(this.grid.push(s),0==e||e==this.gridHeight-1||0==n||n==this.gridWidth-1){var r=this.poolFactory&&this.poolFactory.getObject(this.blockPrefabName);r&&(r.active=!0,r.parent=this.node,r.setPosition(s),this.blocks.push(r),this.blockPositions.push(s))}}cc.log("Init Map with Grid Positions: "+this.grid)},setUpMoreBlocks:function(t){this.currentLevel=t;var o=this.config,i=o.STEP_DISTANCE,e=o.LEVELS;if(e&&e.length>t){var n=e[this.currentLevel];if(n){var s=n.MORE_BLOCKS;if(s&&s.length>0)for(var r=0;r<s.length;r++){var c=this.poolFactory&&this.poolFactory.getObject(this.blockPrefabName);if(c){c.active=!0,c.parent=this.node;var h=s[r],a=cc.v2(i*h.x,i*h.y);c.setPosition(a),this._currentBlockColor&&(c.color=this._currentBlockColor),this.moreBlocks.push(c),this.moreBlockPositions.push(a)}}}}},start:function(){},resetMap:function(){this._currentFood&&this.poolFactory&&this.poolFactory.removeObject(this._currentFood);for(var t=0;t<this.moreBlocks.length;t++){var o=this.moreBlocks[t];o&&this.poolFactory&&this.poolFactory.removeObject(o)}this.moreBlocks=[],this.moreBlockPositions=[]},removeEatenFood:function(t){t&&(this.poolFactory&&this.poolFactory.removeObject(t),this._currentFood=null)},spawnFood:function(t){for(var o=[].concat(e(this.blockPositions)),i=0;i<this.moreBlockPositions.length;i++)o.push(this.moreBlockPositions[i]);if(t&&t.length>0)for(var n=0;n<t.length;n++)o.push(t[n]);var s=this.getRandomPosWithExceptions(o);cc.log("Spawn Food at Position: "+s);var r=this.poolFactory&&this.poolFactory.getObject(this.foodPrefabName);r.active=!0,r.parent=this.node,r.setPosition(s),this._currentFoodColor&&(r.color=this._currentFoodColor),this._currentFood=r},getRandomPosWithExceptions:function(t){for(var o=[],i=0;i<this.grid.length;i++){for(var e=!1,n=this.grid[i],s=0;s<t.length;s++){if(t[s].equals(n)){e=!0;break}}e||o.push(n)}return cc.log("Remaining grid after exclude exceptions: "+o),o[Math.floor(Math.random()*(o.length-1))]},changeFoodColor:function(t){this._currentFoodColor=t,this._currentFood&&(this._currentFood.color=t)},changeBlockColor:function(t){this._currentBlockColor=t;for(var o=0;o<this.blocks.length;o++){var i=this.blocks[o];i&&(i.color=t)}for(var e=0;e<this.moreBlocks.length;e++){var n=this.moreBlocks[e];n&&(n.color=t)}}}),cc._RF.pop()},{}],MovementControl:[function(t,o,i){"use strict";cc._RF.push(o,"4b2d3aC1gtHJolxUOlCq/cn","MovementControl"),cc.Class({extends:cc.Component,properties:{_horizontalAxis:0,horizontalAxis:{get:function(){return this._horizontalAxis},set:function(t){this._horizontalAxis!==t&&(this._horizontalAxis=t,this.onUpdateMovement())},visible:!1},_verticalAxis:0,verticalAxis:{get:function(){return this._verticalAxis},set:function(t){this._verticalAxis!==t&&(this._verticalAxis=t,this.onUpdateMovement())},visible:!1},player:cc.Node},initGame:function(t,o){this.poolFactory=o,t&&this.poolFactory&&this.player&&this.player.emit("INIT_PLAYER",t,this.poolFactory)},onUpdateMovement:function(){cc.log("Horizontal Axis: "+this._horizontalAxis+"; Vertical Axis: "+this._verticalAxis);var t={x:this._horizontalAxis,y:this._verticalAxis};this.player&&this.player.emit("UPDATE_DIRECTION",t)},resetInput:function(){this._verticalAxis=0,this._horizontalAxis=0},startMoving:function(){this.player&&this.player.emit("START_MOVING")},stopMoving:function(){this.player&&this.player.emit("STOP_MOVING")}}),cc._RF.pop()},{}],PlayerControl:[function(t,o,i){"use strict";cc._RF.push(o,"63dbd1H/YNEJqoVIhrCHGDA","PlayerControl"),cc.Class({extends:cc.Component,properties:{paths:{type:cc.Vec2,default:[]},headPrefabName:"Head",bodyPrefabName:"Body",initialBodyCount:2,_isMoving:!1,isMoving:{get:function(){return this._isMoving},set:function(t){this._isMoving=t},visible:!1}},onLoad:function(){this.node.on("INIT_PLAYER",this.init,this),this.node.on("START_MOVING",this.startMoving,this),this.node.on("STOP_MOVING",this.stopMoving,this),this.node.on("UPDATE_DIRECTION",this.onUpdateDirection,this)},start:function(){},reset:function(){this.head&&(this.head.x=this.head.y=0),this._direction=this._currentDirection=cc.v2(0,0),this._isMoving=!1,this.paths=[];var t=cc.v2(this.head.x,this.head.y);this.paths.push(t);for(var o=this.config,i=o.STEP_SPEED,e=o.HEAD_WIDTH,n=o.HEAD_HEIGHT,s=o.BODY_WIDTH,r=o.BODY_HEIGHT,c=0;c<this.bodies.length;c++){var h=this.bodies[c];h&&this.poolFactory&&this.poolFactory.removeObject(h)}this.bodies=[];for(var a=0;a<this.initialBodyCount;a++){var l=this.poolFactory&&this.poolFactory.getObject(this.bodyPrefabName);if(l){l.active=!0,l.parent=this.node,l.width=s+1,l.height=r+1,l.x=-(a*s+e)*this.initDirection.x,l.y=-(a*r+n)*this.initDirection.y;var u=cc.v2(l.x,l.y);this.paths.push(u),this.bodies.push(l)}}this.head.setSiblingIndex(this.bodies.length),i&&(this.stepSpeed=i)},init:function(t,o){this.config=t,this.poolFactory=o,this.bodies=[];var i=this.config,e=i.MIN_DISTANCE,n=i.STEP_DISTANCE,s=i.STEP_SPEED,r=i.INIT_DIRECTION,c=i.HEAD_WIDTH,h=i.HEAD_HEIGHT,a=i.BODY_WIDTH,l=i.BODY_HEIGHT;if(n&&(this.stepDistance=n),s&&(this.stepSpeed=s),r&&(this.initDirection=r),this._minDist=e,this.headPrefabName&&!this.head){this.head=this.poolFactory&&this.poolFactory.getObject(this.headPrefabName),this.head.active=!0,this.head.parent=this.node,this.head.width=c+2,this.head.height=h+2,this.head.x=0,this.head.y=0;var u=cc.v2(this.head.x,this.head.y);this.paths.push(u);var d=this.head.getComponent("HeadControl");d&&d.init(this)}if(this.bodyPrefabName)for(var p=0;p<this.initialBodyCount;p++){var C=this.poolFactory&&this.poolFactory.getObject(this.bodyPrefabName);if(C){C.active=!0,C.parent=this.node,C.width=a+1,C.height=l+1,C.x=-(p*a+c)*this.initDirection.x,C.y=-(p*l+h)*this.initDirection.y;var v=cc.v2(C.x,C.y);this._currentBodyColor&&(C.color=this._currentBodyColor),this.paths.push(v),this.bodies.push(C)}}this.head.setSiblingIndex(this.bodies.length)},increaseSpeed:function(t){this.stepSpeed+=t},onCollideBlock:function(){cc.log("Collide Block"),this.node.emit("ON_COLLIDE_BLOCK")},onEatFood:function(t){cc.log("Eat Food"),t&&(this.node.emit("ON_EAT_FOOD",t),this.addBodyPart())},addBodyPart:function(){var t=this.bodies[this.bodies.length-1],o=cc.v2(t.x-this._currentDirection.x*this.stepDistance,t.y-this._currentDirection.y*this.stepDistance),i=this.poolFactory&&this.poolFactory.getObject(this.bodyPrefabName),e=this.config,n=e.BODY_WIDTH,s=e.BODY_HEIGHT;i&&(i.active=!0,i.parent=this.node,i.width=n+1,i.height=s+1,i.setPosition(o),this._currentBodyColor&&(i.color=this._currentBodyColor),this.paths.push(o),this.bodies.push(i)),this.head.setSiblingIndex(this.bodies.length)},startMoving:function(){this._currentDirection=this._direction=this.initDirection,this.lastPos=this.nextPos=cc.v2(this.head.x+this._currentDirection.x*this.stepDistance,this.head.y+this._currentDirection.y*this.stepDistance),this._isMoving=!0},stopMoving:function(){this._isMoving=!1},onFinishStep:function(t){this._currentDirection=this._direction,this.paths.unshift(t),this.paths.pop(),this.lastPos=t,this.nextPos=cc.v2(this.lastPos.x+this._currentDirection.x*this.stepDistance,this.lastPos.y+this._currentDirection.y*this.stepDistance)},onUpdateDirection:function(t){this._direction=t,cc.log(">>>>>> Player Direction: "+this._direction.x+","+this._direction.y)},changeHeadColor:function(t){this.head.color=t},changeBodyColor:function(t){this._currentBodyColor=t;for(var o=0;o<this.bodies.length;o++){var i=this.bodies[o];i&&(i.color=t)}},update:function(t){if(this._isMoving){var o=this.nextPos.x-this.head.x,i=this.nextPos.y-this.head.y,e=cc.v2(o,i);if(e=e.normalizeSelf(),Math.abs(o)>this._minDist||Math.abs(i)>this._minDist){var n=e.x*this.stepSpeed*t,s=e.y*this.stepSpeed*t;this.head.x+=n,this.head.y+=s}else this.head.x=this.nextPos.x,this.head.y=this.nextPos.y,this.onFinishStep(this.nextPos);for(var r=0;r<this.bodies.length;r++){var c=this.bodies[r],h=this.paths[r];if(c&&h){var a=h.x-c.x,l=h.y-c.y,u=cc.v2(a,l);u=u.normalizeSelf(),Math.abs(a)>this._minDist||Math.abs(l)>this._minDist?(c.x+=u.x*this.stepSpeed*t,c.y+=u.y*this.stepSpeed*t):(c.x=h.x,c.y=h.y)}}}},onDestroy:function(){this.node.off("INIT_PLAYER",this.init,this),this.node.off("START_MOVING",this.startMoving,this),this.node.off("STOP_MOVING",this.stopMoving,this),this.node.off("UPDATE_DIRECTION",this.onUpdateDirection,this)}}),cc._RF.pop()},{}],PoolFactory:[function(t,o,i){"use strict";cc._RF.push(o,"a5326xNHARD8rdfEUkQzHNV","PoolFactory");var e=cc.Class({name:"PoolPrefab",properties:{prefabName:{default:""},objectPrefab:{type:cc.Prefab,default:null},initialCount:5}});cc.Class({extends:cc.Component,properties:{poolPrefabList:{type:e,default:[]}},onLoad:function(){this.pools=[];for(var t=0;t<this.poolPrefabList.length;t++){for(var o=this.poolPrefabList[t].prefabName,i=new cc.NodePool(o),e=0;e<this.poolPrefabList[t].initialCount;e++){var n=cc.instantiate(this.poolPrefabList[t].objectPrefab);n.name=o,n.active=!1,i.put(n)}var s={prefabName:this.poolPrefabList[t].prefabName,objectPrefab:this.poolPrefabList[t].objectPrefab,pool:i};this.pools[t]=s}},getObject:function(t){for(var o=null,i=0;i<this.pools.length;i++){var e=this.pools[i],n=e.prefabName,s=e.objectPrefab,r=e.pool;if(n==t){r.size()>0?o=r.get():((o=cc.instantiate(s)).name=n,o.active=!1);break}}return o},removeObject:function(t){for(var o=t.name,i=0;i<this.pools.length;i++){var e=this.pools[i],n=e.prefabName,s=e.pool;if(o==n){t.active=!1,s.put(t);break}}},onDestroy:function(){for(var t=0;t<this.pools.length;t++){var o=this.pools[t].pool;o&&o.clear(),this.poolPrefabList[t].objectPrefab=null}this.pools=[],this.pools=null,this.poolPrefabList=[],this.poolPrefabList=null}}),cc._RF.pop()},{}],SettingPanelControl:[function(t,o,i){"use strict";cc._RF.push(o,"eadabR1/HROx7ao8uSWHM+W","SettingPanelControl");var e=t("ColorPalletControl");cc.Class({extends:cc.Component,properties:{colorPallets:{type:e,default:[]}},init:function(t,o){for(var i=0;i<this.colorPallets.length;i++){var e=this.colorPallets[i];e&&e.init(t,o)}this.node.active=!1},loadData:function(){for(var t=0;t<this.colorPallets.length;t++){var o=this.colorPallets[t];o&&o.loadColorData()}},show:function(){this.node.active=!0;for(var t=0;t<this.colorPallets.length;t++){var o=this.colorPallets[t];o&&o.onOpen()}},hide:function(){for(var t=0;t<this.colorPallets.length;t++){var o=this.colorPallets[t];o&&o.onClose()}this.node.active=!1}}),cc._RF.pop()},{ColorPalletControl:"ColorPalletControl"}],TouchInputControl:[function(t,o,i){"use strict";cc._RF.push(o,"5f1eewR7/1LLrpI2ZQyzWo5","TouchInputControl");var e=t("MovementControl");cc.Class({extends:cc.Component,properties:{movementControl:e,camera:cc.Camera,trailNode:cc.Node},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this._touchPos=cc.v2(0,0),this._deltaPosArr=[]},onUpButtonClick:function(t){console.log("Move Up"),this.movementControl&&(this.movementControl.resetInput(),this.movementControl.verticalAxis=1)},onDownButtonClick:function(t){console.log("Move Down"),this.movementControl&&(this.movementControl.resetInput(),this.movementControl.verticalAxis=-1)},onLeftButtonClick:function(t){console.log("Move Left"),this.movementControl&&(this.movementControl.resetInput(),this.movementControl.horizontalAxis=-1)},onRightButtonClick:function(t){console.log("Move Right"),this.movementControl&&(this.movementControl.resetInput(),this.movementControl.horizontalAxis=1)},onTouchStart:function(t){var o=t.touch;if(o&&(this._touchPos=o.getLocation(),this.trailNode)){this.trailNode.active=!0;var i=this.getWorldPositionFromScreenPoint(this._touchPos);this.trailNode.position=this.node.convertToNodeSpaceAR(i)}this._deltaPosArr=[]},onTouchMove:function(t){var o=t.touch;if(o){var i=o.getDelta();if(this._deltaPosArr.push(i),this._touchPos=o.getLocation(),this.trailNode){var e=this.getWorldPositionFromScreenPoint(this._touchPos);this.trailNode.position=this.node.convertToNodeSpaceAR(e)}}},onTouchEnd:function(t){var o=t.touch;if(o)o.getLocation();this.trailNode&&(this.trailNode.active=!1),this.calculateMovingDirection()},onTouchCancel:function(t){this.trailNode&&(this.trailNode.active=!1),this.calculateMovingDirection()},calculateMovingDirection:function(){for(var t=cc.v2(0,0),o=0;o<this._deltaPosArr.length;o++){var i=this._deltaPosArr[o];i&&(t.x+=i.x,t.y+=i.y)}return t=t.normalizeSelf(),cc.log("Normalize Swipe Direction: "+t),this.movementControl&&(this.movementControl.resetInput(),Math.abs(t.x)>Math.abs(t.y)?this.movementControl.horizontalAxis=t.x>0?1:-1:Math.abs(t.x)<Math.abs(t.y)&&(this.movementControl.verticalAxis=t.y>0?1:-1)),t},getWorldPositionFromScreenPoint:function(t){var o=cc.v2(0,0);return this.camera.getScreenToWorldPoint(t,o)},onDestroy:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)}}),cc._RF.pop()},{MovementControl:"MovementControl"}],UIControl:[function(t,o,i){"use strict";cc._RF.push(o,"c5b06hrMXxCfLUVQkoEccOv","UIControl"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,levelLabel:cc.Label,startButton:cc.Node,reStartButton:cc.Node,nextLevelButton:cc.Node,pauseButton:cc.Node,resumeButton:cc.Node,_currentLevelName:"0",level:{get:function(){return this._currentLevelName},set:function(t){this._currentLevelName=t,this.config?this.levelLabel.string="Level: "+this.config.TILE+"-"+this._currentLevelName:this.levelLabel.string="Level: "+this._currentLevelName},visible:!1},_currentScore:0,currentScore:{get:function(){return this._currentScore},visible:!1}},onLoad:function(){},start:function(){this._currentScore=0,this.scoreLabel&&(this.scoreLabel.string="Score: 0"),this.startButton&&(this.startButton.active=!0)},init:function(t){this.config=t},pauseGame:function(){this.pauseButton&&(this.pauseButton.active=!1),this.resumeButton&&(this.resumeButton.active=!0),this.node.emit("PAUSE_GAME")},resumeGame:function(){this.pauseButton&&(this.pauseButton.active=!0),this.resumeButton&&(this.resumeButton.active=!1),this.node.emit("RESUME_GAME")},onScored:function(t){this._currentScore+=t,this.scoreLabel&&(this.scoreLabel.string="Score: "+this._currentScore)},startGame:function(){this.startButton&&(this.startButton.active=!1),this.pauseButton&&(this.pauseButton.active=!0),this.resumeButton&&(this.resumeButton.active=!1),this.node.emit("START_GAME")},reStartGame:function(){this.reStartButton&&(this.reStartButton.active=!1),this.pauseButton&&(this.pauseButton.active=!0),this.node.emit("RESTART_GAME"),this._currentScore=0,this.scoreLabel&&(this.scoreLabel.string="Score: 0")},goNext:function(){this.nextLevelButton&&(this.nextLevelButton.active=!1),this.pauseButton&&(this.pauseButton.active=!0),this.node.emit("NEXT_LEVEL")},onGameWon:function(){this.nextLevelButton&&(this.nextLevelButton.active=!0),this.pauseButton&&(this.pauseButton.active=!1),this.resumeButton&&(this.resumeButton.active=!1)},onGameOver:function(){this.reStartButton&&(this.reStartButton.active=!0),this.pauseButton&&(this.pauseButton.active=!1),this.resumeButton&&(this.resumeButton.active=!1)},onOpenSetting:function(){this.node.emit("OPEN_SETTING")},onCloseSetting:function(){this.node.emit("CLOSE_SETTING")}}),cc._RF.pop()},{}]},{},["CanvasScaleByOrientation","ColorPalletControl","Config","GameControl","HeadControl","KeyboardInputControl","MapControl","MovementControl","PlayerControl","PoolFactory","SettingPanelControl","TouchInputControl","UIControl"]);